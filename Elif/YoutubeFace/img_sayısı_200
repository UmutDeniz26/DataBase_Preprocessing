import os
import shutil
import random

# Veri setinin bulunduğu dizin
dataset_path = "./Elif/YoutubeFace/YoutubeFace"

# Yeni klasör adı
new_dataset_name = "./Elif/YoutubeFace/yenidataset"

# Çıktı dosyasının adı
output_file = './Elif/YoutubeFace/output_img_200sayisi.txt'

counter = 0
a=0

# Dosya açma işlemi
with open(output_file, 'w') as file:
    file.write("PersonName_SubfolderName_TotalImg_MoreThan200Img\n")
    for person_name in os.listdir(dataset_path):
        person_path = os.path.join(dataset_path, person_name)

        if os.path.isdir(person_path):
            person_images = []

            for subfolder_name in os.listdir(person_path):
                subfolder_path = os.path.join(person_path, subfolder_name)

                if os.path.isdir(subfolder_path):
                    total_img = len(os.listdir(subfolder_path))
                    if total_img >= 200:
                        a+=1
                        person_images.append(f'{person_name}_{subfolder_name}_{total_img}_{a}')
                        # Her n görselde bir img seçmek için
                        n =int(total_img/200)
                        secilen_gorseller = random.sample(os.listdir(subfolder_path), n)
                        yeni_klasor_yolu = os.path.join(new_dataset_name, person_name, f"{subfolder_name}_sampled")

                        # Yeni klasörü oluştur
                        os.makedirs(yeni_klasor_yolu, exist_ok=True)

                        for secilen_gorsel in secilen_gorseller:
                            gorsel_yolu = os.path.join(subfolder_path, secilen_gorsel)
                            yeni_gorsel_yolu = os.path.join(yeni_klasor_yolu, secilen_gorsel)
                            shutil.copy(gorsel_yolu, yeni_gorsel_yolu)

                    

            # Person'a ait tüm görselleri tek bir satırda listeleyerek yaz
                    file.write('\n'.join(person_images))
                    file.write('\n')

                    counter += 1



# Bilgileri içeren txt dosyası oluşturuldu
print(f"{n} görselden 1 tanesi seçilerek kopyalama işlemi tamamlandı.")
print(f'Liste oluşturuldu ve {output_file} adında kaydedildi.')

def 
